---
# Azure VM 相關測試
# edit by sakan 2020/9/15
- name: use when conditionals and setup module
  hosts: localhost
  vars_prompt:
    - name: "sequence_start"
      prompt: "Enter sequence start number"
      private: no
      default: 1

    - name: "sequence_end"
      prompt: "Enter sequence end number, Max is 99"
      private: no
      default: 10

    - name: "resource_group"
      prompt: "Enter resource group name"
      private: no
      default: sakanastudy

  tasks:
   - name: Remove Azure test VM
     with_sequence: start={{ sequence_start }} end={{ sequence_end }} stride=1 format=test%02u
     azure_rm_virtualmachine:
       resource_group: "{{ resource_group }}"
       name: "{{ item }}"
       state: absent
